-------------------------------------------------------------------------------
--                 L  O  C  A  L     V  A  R  I  A  B  L  E  S
-------------------------------------------------------------------------------

local addonName, L = ...;

local cpjGetPetStats       = C_PetJournal.GetPetStats;
local cpjGetPetInfoByPetID = C_PetJournal.GetPetInfoByPetID;
local floor                = math.floor;
local bitAnd               = bit.band;

local petBreeds =
{
  [0x00000001] = "(B/B)", --  3/13
  [0x00000002] = "(P/P)", --  4/14
  [0x00000004] = "(S/S)", --  5/15
  [0x00000008] = "(H/H)", --  6/16
  [0x00000010] = "(H/P)", --  7/17
  [0x00000020] = "(P/S)", --  8/18
  [0x00000040] = "(H/S)", --  9/19
  [0x00000080] = "(P/B)", -- 10/20
  [0x00000100] = "(S/B)", -- 11/21
  [0x00000200] = "(H/B)", -- 12/22
};

local baseStatProfiles =
{
  {8.5,7.5,8},{7,8.5,8.5},{6.5,9,8.5},{7,9,8},{7.5,7.5,9},{8,7.5,8.5},{9,7,8},
  {9,8,7},{8.5,8,7.5},{8,8,8},{8.5,7,8.5},{8.5,9,6.5},{8,7,9},{7.5,8.5,8},
  {8,8.5,7.5},{7,7,10},{8.5,8.5,7},{8,8.005,8},{7.5,8,8.5},{7.5,7,9.5},
  {9,7.5,7.5},{9,9,6},{7.5,9,7.5},{8,9,7},{9.5,8,6.5},{9.5,8.5,6},{8,9.5,6.5},
  {8,8.75,7.25},{7.75,8.5,7.75},{7,8,9},{9,6.5,8.5},{6,8,10},{8,6.5,9.5},
  {9,8.5,6.5},{9.5,7.5,7},{6.5,8,9.5},{6.75,10.5,6.75},{7.5,8.25,8.25},
  {8.25,8,7.75},{8,8.25,7.75},{7.75,8,8.25},{8.25,8.25,7.5},{7.75,8.25,8},
  {8.25,8.5,7.25},{8.3,7.9,7.8},{8.125,6.875,9},{13,8,5.5},{7.625,7.875,8.5},
  {7.625,8.25,8.125},{7.75,7.75,8.5},{9.75,7.25,7},{7.5,9.5,7},{6.75,9.25,8},
  {8.75,8,7.25},{8.5,8.75,6.75},{7.25,8.75,8},{7.625,8.375,8},
  {9.5,8.5,-1.375},{8.25,7.75,8},{8,7.75,8.25},{9,7.625,7.375},
  {8.75,7.75,7.5},{7.625,8,8.375},{8.5,8.25,7.25},{8,9.25,6.75},
  {7.75,8.125,8.125},{8.25,8.5,8.5},{8.75,7.875,7.375},{7.75,7.5,8.75},
  {8.75,7.625,7.625},{8,7.25,8.75},{7.625,7.75,8.625},{7.5,8.75,7.75},
  {7.625,7.625,8.75},{7.25,8.375,8.375},{7.625,8.75,7.625},{8.25,7.25,8.5},
  {6.5,8.75,8.75},{8.375,8.375,7.25},{7.875,8.25,7.875},{8.165,8.165,7.67},
  {7.5,8.125,8.375},{8,7.625,8.375},{8.125,7.875,8},{8.625,8.375,7},
  {8.625,8.625,6.75},{7.75,8.375,7.875},{8.125,8.125,7.75},{7.75,7.875,8.375},
  {8.375,8,7.625},{7.875,7.625,8.5},{8.125,7.75,8.125},{7.5,8.375,8.125},
  {7.875,7.875,8.25},{8.25,7.875,7.875},{8,7.875,8.125},{7.875,8,8.125},
  {8.375,7.875,7.75},{7.875,7.75,8.375},{8.25,7.625,8.125},{8.375,8.125,7.5},
  {8.125,8.375,7.5},{7.625,8.625,7.75},{8.625,7.75,7.625},{7.75,8.75,7.5},
  {7.75,8.625,7.625},{8.375,7.625,8},{7.375,8.625,8},{7.625,8.875,7.5},
  {7.25,8.25,8.5},{9.5,7.25,7.25},{7.25,7.25,9.5},{8.25,9,6.75},{7.25,7,9.75},
  {7.25,9.75,7},{10.5,6.25,7.25},{6.75,8.625,8.625},{9.125,8.375,6.5},
  {7.5,7.875,8.625},{9.125,6.25,8.625},{8,8.1,7.9},{8.15,8.15,7.7},
  {8.9,8,7.1},{7.25,8.45,8.3},{7.1,8.7,8.2},{7.775,7.775,8.45},{7.4,8.3,8.3},
  {7.1,8.45,8.45},{8.6,8,7.4},{6.5,8.9,8.6},{8.2,8,7.8},{8.1,8,7.9},
  {8.125,8,7.875},{7.825,8,8.175},{7.9,8.05,8.05},{7.85,7.85,8.3},{8.3,7.7,8},
  {7.825,8.175,8},{7.6,8.4,8},{7.8,8.2,8},{8.5,7.25,8.25},{8.225,7.7,8.075},
  {7.55,8.9,7.55},{7.5,8.875,7.625},{7.725,8.275,8},{7.25,7.875,8.875},
  {8.875,7.625,7.5},{7.8,8.1,8.1},{8.875,8,7.125},{7.5,8.83,7.67},
  {7.505,8.33,8.165},{7.325,8.175,8.5},{8.075,8.325,7.6},{8.15,7.925,7.925},
  {7.55,8.3,8.15},{8.275,8.175,7.55},{8.25,8.125,7.625},{8.15,8.05,7.8},
  {7.85,7.95,8.2},{8.325,8.175,7.5},{9.125,8.125,6.75},{8,8.875,7.125},
  {8.675,8,7.325},{8.425,8,7.575},{7.875,8.325,7.8},{6.75,8,9.25},
  {8.15,8,7.85},{7.85,8,8.15},{8.075,8,7.925},{8.05,8.05,7.9},
  {8.45,7.925,7.625},{8.6,7.85,7.55},{8.175,8.275,7.55},{7.125,8.375,8.5},
  {6.75,7.5,9.75},{6.75,8.75,8.5},{6.375,9.125,8.5},{7.125,8.25,8.625},
  {8.375,8.25,7.375},{9.125,7.5,7.375},{7.125,9.175,7.7},{9.625,7.125,7.25},
  {10.25,6.875,6.875},{7.325,8.45,8.225},{8.15,7.575,8.275},{7.25,9.25,7.5},
  {8.7,8.3,7},{8.725,8.275,7},{7.25,9,7.75},{7.825,8.675,7.5},
  {8.725,8.775,6.5},{7.875,8.675,7.45},{8.575,8.425,7},{8.575,7.575,7.85},
  {7.25,8.925,7.825},{9.725,8.275,6},{7.225,9.775,7},{8.75,7.375,7.875},
  {5.75,9.125,9.125},{6.875,9.125,8},{7.5,8.575,7.925},{7.125,9.625,7.25},
  {8,9.125,6.875},{10.275,7,6.725},{7.375,9.125,7.5},{6.75,9.625,7.625},
  {6.75,9.125,8.125},{6.75,8.275,8.975},{8.575,8.325,7.1},{7.375,8.25,8.375},
  {7.65,8.175,8.175},{8,8.275,7.725},{7.5,8.175,8.325},{7.75,8.875,7.375},
  {7.675,8.65,7.675},{8,8.325,7.675},{7.55,8.175,8.275},{7.925,8.15,7.925},
  {7.675,7.825,8.5},{7.425,7.825,8.75},{7.85,8.075,8.075},{9.25,7.75,7},
  {7.5,8.325,8.175},{8,8.375,7.625},{8.625,8,7.375},{7.25,7.5,9.25},
  {8.625,8.25,7.125},{9,7.75,7.25},{7.675,8.5,7.825},{7.325,8.675,8},
  {8.325,8.325,7.35},{9.11,8.555,6.335},{8.5,8.375,7.125},{7.025,8.475,8.5},
  {7.2,8.275,8.525},{7.4,8.6,8},{7.25,7.75,9},{8.25,8.65,7.1},{8.75,8,7.625},
  {6.335,9.11,8.555},{7.1,8.275,8.625},{8,8.625,8.625},{7.875,8.875,7.25},
  {8.75,8.25,7},{7.25,8,8.75},{7.825,8.05,8.125},{8.325,8.675,7},
  {7.95,7.8,8.25},{8.5,8.5,7.5},{8,8.5,11},{8.625,8.125,7.25},{8.75,8.5,6.75},
  {8.25,7.5,8.25},{7.65,7.85,8.5},{8.5,7.75,7.75},{7.625,9.25,7.625},
  {7.625,8.125,8.25},{7.875,8.5,7.625},{8.75,7.25,8},{7.25,8.5,8.25},
  {25.5,10.5,8},{6,9,9},{9.25,8.25,6.5},{8.25,9.25,6.5},{7.75,9.25,7},
  {7.5,7.75,8.75},{7.625,9,7.625},{7.25,9.5,7.25},{7.5,8.5,8.5},
  {9.25,7.5,7.25},{6.5,8.5,9},{7.75,8.5,8.25},{7.75,9,7.25},{6.75,8.5,8.75},
  {8.5,8,9},{5.5,8.5,10},{5.5,10,8.5},{8.375,9.125,6.5},{9.5,6,8.5},
  {9.5,6.5,8},{6,8.5,9.5},{7,8.25,8.75},{8.25,7,8.75},{9.25,8,6.75},
  {8.25,8.75,7},{8.375,8.625,7},{7.5,8,8.25},{6.335,8.555,9.11},
  {8.75,8.5,7.75},{9.25,6.75,8},{7.5,9.25,7.25},{6.75,8.5,7.25},
  {8.25,7.4,8.35},{8.125,7,8.875},{7.5,8.5,9},{7.5,9,8.5},{7.875,9,7.125},
  {7.5,8.675,7.825},{6.75,8.25,9},
};

local speciesInfo =
{
  [39]=131073,[40]=16386,[41]=1026,[42]=8195,[43]=516,[44]=2050,[45]=514,
  [46]=262149,[47]=2566,[49]=519,[50]=131080,[51]=2569,[52]=459274,[55]=39435,
  [56]=16396,[57]=1025,[58]=16388,[59]=32777,[64]=32769,[65]=262145,
  [67]=82442,[68]=12810,[69]=197125,[70]=264710,[72]=133645,[74]=131077,
  [75]=2062,[77]=522,[78]=262158,[83]=16385,[84]=459274,[85]=32769,[86]=8193,
  [87]=2063,[89]=4106,[90]=8194,[92]=522,[93]=1027,[94]=2064,[95]=522,
  [106]=65537,[107]=522,[111]=262154,[114]=262161,[115]=522,[116]=262154,
  [117]=522,[118]=522,[119]=522,[120]=522,[121]=522,[122]=2066,[124]=522,
  [125]=2058,[126]=65546,[127]=8198,[128]=522,[130]=522,[131]=16390,
  [132]=4104,[136]=336394,[137]=133645,[138]=262657,[139]=279054,[140]=263695,
  [141]=266757,[142]=2575,[143]=18958,[144]=133637,[145]=23041,[146]=297491,
  [149]=32788,[153]=8202,[155]=8202,[156]=522,[157]=522,[158]=522,[159]=4106,
  [160]=1034,[162]=65551,[163]=16399,[164]=527,[165]=32769,[166]=8209,
  [167]=37397,[168]=2049,[169]=2570,[170]=8202,[171]=8202,[172]=65550,
  [173]=8207,[174]=527,[175]=2062,[179]=8201,[180]=8201,[183]=522,[186]=19982,
  [187]=16401,[188]=4113,[189]=522,[190]=274449,[191]=513,[192]=32778,
  [193]=1039,[194]=182794,[195]=182277,[196]=8201,[197]=16403,[198]=131082,
  [199]=65546,[200]=2061,[201]=8202,[202]=8202,[203]=262157,[204]=522,
  [205]=8202,[206]=164369,[207]=16394,[209]=522,[210]=2058,[211]=4105,
  [212]=522,[213]=2058,[215]=65537,[217]=8202,[218]=1025,[220]=32778,
  [224]=65538,[225]=522,[226]=1034,[227]=1034,[228]=8202,[229]=522,[231]=521,
  [232]=16386,[233]=16386,[234]=65538,[235]=65538,[236]=4110,[237]=514,
  [238]=131074,[239]=1034,[240]=529,[241]=262154,[242]=16398,[243]=65558,
  [244]=8204,[245]=16394,[246]=522,[247]=4106,[248]=16394,[249]=8209,
  [250]=16407,[251]=529,[253]=522,[254]=18954,[255]=4119,[256]=8216,
  [258]=4108,[259]=262145,[260]=16399,[261]=1025,[262]=2049,[264]=16401,
  [265]=4121,[266]=16401,[267]=522,[268]=1036,[270]=32785,[271]=98822,
  [272]=36885,[277]=131073,[278]=32778,[279]=16394,[285]=65560,[286]=8200,
  [287]=518,[289]=4122,[291]=262165,[292]=522,[293]=32778,[294]=16394,
  [296]=522,[297]=1051,[298]=522,[301]=131074,[302]=8209,[303]=2050,
  [306]=131074,[307]=522,[308]=522,[309]=16387,[310]=16394,[311]=521,
  [316]=513,[317]=529,[318]=526,[319]=65539,[320]=8193,[321]=4106,[323]=16394,
  [325]=83991,[328]=1034,[329]=16394,[330]=65546,[333]=131082,[335]=262165,
  [337]=262154,[338]=8193,[339]=262154,[340]=522,[341]=522,[342]=522,
  [343]=16898,[346]=522,[347]=540,[348]=16401,[374]=516106,[378]=436749,
  [379]=461318,[380]=262666,[381]=32778,[382]=541,[383]=147462,[385]=412166,
  [386]=133638,[387]=2579,[388]=12809,[389]=523777,[391]=35341,[392]=166406,
  [393]=440331,[395]=12809,[396]=147458,[397]=426506,[398]=166406,[399]=18963,
  [400]=165378,[401]=12809,[402]=295433,[403]=84499,[404]=262662,[405]=9747,
  [406]=45569,[407]=150018,[408]=133651,[409]=83998,[410]=166406,[411]=1546,
  [412]=133634,[414]=16906,[415]=45070,[416]=18954,[417]=166406,[418]=131603,
  [419]=131585,[420]=270849,[421]=295439,[422]=18958,[423]=37393,[424]=440331,
  [425]=82451,[427]=33282,[428]=150018,[429]=46094,[430]=2063,[431]=49171,
  [432]=16906,[433]=10771,[437]=66058,[438]=36883,[439]=36873,[440]=17930,
  [441]=43021,[442]=307231,[443]=436746,[445]=110602,[446]=38409,[447]=428550,
  [448]=436749,[449]=133642,[450]=4616,[452]=461322,[453]=12296,[454]=166406,
  [455]=90122,[456]=29199,[457]=36872,[458]=4625,[459]=150018,[460]=37390,
  [461]=520,[463]=36886,[464]=35338,[465]=17922,[466]=10771,[467]=45582,
  [468]=45582,[469]=46594,[470]=140802,[471]=121345,[472]=228865,[473]=33301,
  [474]=2080,[475]=262667,[477]=131589,[478]=426505,[479]=131617,[480]=37391,
  [482]=2579,[483]=262657,[484]=150018,[485]=45077,[487]=469514,[488]=262163,
  [489]=82959,[491]=18436,[492]=37391,[493]=12826,[494]=12810,[495]=262657,
  [496]=295450,[497]=307211,[498]=49673,[499]=8198,[500]=95754,[502]=262657,
  [503]=133637,[504]=67087,[505]=141843,[506]=168450,[507]=295438,[508]=9738,
  [509]=45066,[511]=133651,[512]=300046,[513]=523786,[514]=523786,
  [515]=523786,[517]=16906,[518]=4642,[519]=45065,[521]=65540,[523]=36872,
  [525]=264714,[528]=294931,[529]=9226,[530]=45578,[532]=5132,[534]=85518,
  [535]=33290,[536]=40969,[537]=13833,[538]=20497,[539]=461318,[540]=461318,
  [541]=47115,[542]=262657,[543]=35342,[544]=395281,[545]=18954,[546]=299022,
  [547]=240141,[548]=523790,[549]=461322,[550]=461318,[552]=144910,
  [553]=461318,[554]=41486,[555]=47115,[556]=299022,[557]=207886,[558]=16394,
  [559]=46103,[560]=68097,[562]=18963,[564]=266787,[565]=262657,[566]=295429,
  [567]=67603,[568]=33306,[569]=262657,[570]=66058,[571]=2579,[572]=5129,
  [573]=199175,[626]=224275,[627]=73745,[628]=66057,[629]=9737,[630]=84493,
  [631]=40979,[632]=66067,[633]=303626,[634]=33282,[635]=82451,[637]=133642,
  [638]=47115,[639]=461318,[640]=436749,[641]=436749,[644]=461318,[645]=49674,
  [646]=395786,[647]=215562,[648]=274965,[649]=25109,[650]=16393,[652]=131082,
  [665]=131086,[666]=8204,[671]=16394,[675]=461318,[677]=18954,[678]=36874,
  [679]=133130,[680]=133130,[699]=426498,[702]=264705,[703]=131594,
  [706]=18954,[707]=2570,[708]=461318,[709]=395782,[710]=164362,[711]=133642,
  [712]=133642,[713]=33301,[714]=198146,[716]=40962,[717]=301070,[718]=49674,
  [722]=360974,[723]=37397,[724]=67594,[725]=131594,[726]=10754,[727]=412170,
  [728]=395786,[729]=436749,[730]=428557,[731]=40962,[732]=49167,[733]=133642,
  [737]=18468,[739]=18462,[740]=492038,[741]=262666,[742]=2570,[743]=264730,
  [744]=440331,[745]=33290,[746]=5132,[747]=360974,[748]=518671,[749]=133130,
  [750]=133642,[751]=426502,[752]=263701,[753]=33294,[754]=453130,[755]=81951,
  [756]=35339,[757]=2057,[758]=16398,[792]=262671,[802]=1041,[817]=8201,
  [818]=16399,[819]=2062,[820]=262154,[821]=131082,[823]=297482,[834]=8201,
  [835]=2058,[836]=2068,[837]=523785,[838]=523786,[844]=2063,[845]=82442,
  [846]=2080,[847]=262154,[848]=35341,[851]=10771,[855]=526,[856]=294922,
  [868]=32778,[903]=65559,[1013]=37397,[1039]=4101,[1040]=4106,[1042]=16421,
  [1061]=2058,[1062]=360966,[1063]=16401,[1068]=84493,[1073]=262154,
  [1117]=550,[1124]=16394,[1125]=522,[1126]=8202,[1127]=16398,[1128]=262666,
  [1142]=131073,[1143]=16394,[1144]=32778,[1145]=2058,[1146]=8202,[1147]=1034,
  [1149]=16394,[1150]=32778,[1151]=8202,[1152]=4110,[1153]=1034,[1154]=32778,
  [1155]=4111,[1156]=16394,[1157]=262666,[1158]=262154,[1159]=262158,
  [1160]=16393,[1161]=82959,[1162]=18436,[1163]=12296,[1164]=133651,
  [1165]=82959,[1166]=82959,[1167]=82959,[1168]=262154,[1174]=262158,
  [1175]=262666,[1176]=522,[1177]=110600,[1178]=1034,[1179]=527,[1180]=84994,
  [1181]=36883,[1182]=262657,[1183]=1034,[1184]=1063,[1185]=32778,
  [1196]=32778,[1197]=8202,[1198]=16394,[1200]=16423,[1201]=65538,
  [1202]=66054,[1204]=131073,[1205]=111143,[1206]=65555,[1207]=262182,
  [1208]=131091,[1209]=531,[1211]=84994,[1212]=84994,[1213]=84994,
  [1226]=85518,[1227]=45065,[1228]=21544,[1229]=84009,[1230]=45098,
  [1231]=459274,[1232]=328235,[1233]=29740,[1234]=45607,[1235]=395274,
  [1236]=16422,[1237]=16424,[1238]=4625,[1243]=16394,[1244]=8202,[1245]=37386,
  [1248]=551,[1255]=8202,[1256]=196618,[1266]=1064,[1276]=19466,[1303]=16426,
  [1304]=16386,[1305]=16393,[1320]=2058,[1321]=93199,[1322]=13329,
  [1323]=200230,[1324]=180746,[1325]=49674,[1326]=49674,[1328]=307722,
  [1329]=182282,[1330]=24083,[1331]=82954,[1332]=7178,[1333]=51741,
  [1334]=45075,[1335]=16394,[1336]=307722,[1337]=5143,[1338]=270849,
  [1343]=60426,[1344]=8231,[1345]=36874,[1346]=32778,[1348]=16394,[1349]=1067,
  [1351]=8202,[1363]=16394,[1364]=1069,[1365]=32778,[1384]=8220,[1385]=85514,
  [1386]=1070,[1387]=95247,[1394]=4105,[1395]=4106,[1396]=16393,[1403]=207882,
  [1411]=65546,[1412]=7178,[1416]=8202,[1426]=4143,[1427]=294448,[1428]=8202,
  [1429]=523786,[1430]=523786,[1432]=523786,[1434]=523786,[1435]=4642,
  [1441]=262657,[1442]=4106,[1446]=65546,[1447]=29706,[1448]=459274,
  [1449]=1034,[1450]=16394,[1451]=2058,[1453]=32778,[1454]=522,[1455]=459274,
  [1456]=459274,[1457]=459274,[1458]=459274,[1462]=459274,[1463]=459274,
  [1464]=459274,[1465]=459274,[1466]=131082,[1467]=3082,[1468]=337457,
  [1469]=337457,[1470]=337457,[1471]=65546,[1478]=8202,[1495]=200242,
  [1511]=2058,[1515]=16394,[1516]=65546,[1517]=1039,[1518]=1039,[1521]=16394,
  [1523]=2058,[1524]=40970,[1530]=1034,[1531]=8203,[1532]=16407,[1533]=16396,
  [1536]=522,[1537]=4106,[1538]=2058,[1539]=1034,[1540]=16394,[1541]=65546,
  [1542]=16394,[1543]=8200,[1544]=65546,[1545]=459274,[1546]=65546,
  [1563]=44042,[1564]=8202,[1565]=207882,[1566]=2058,[1567]=16398,
  [1568]=16394,[1569]=8243,[1570]=16407,[1571]=45578,[1572]=101898,
  [1573]=101898,[1574]=16436,[1575]=65540,[1576]=1077,[1577]=459274,
  [1578]=5143,[1579]=5143,[1581]=5143,[1582]=5143,[1583]=5143,[1586]=49674,
  [1587]=49674,[1588]=49674,[1589]=49674,[1590]=360966,[1591]=360966,
  [1592]=360966,[1593]=360966,[1594]=45578,[1595]=45578,[1596]=16407,
  [1597]=16407,[1598]=37397,[1599]=37397,[1600]=23092,[1601]=1077,
  [1602]=16437,[1603]=32798,[1605]=8219,[1615]=10771,[1622]=4105,
  [1623]=335882,[1624]=1034,[1625]=8202,[1626]=262154,[1627]=32778,
  [1628]=459274,[1629]=458762,[1631]=2058,[1632]=45066,[1633]=65546,
  [1634]=522,[1636]=8202,[1639]=8234,[1655]=405002,[1656]=523786,[1660]=2062,
  [1661]=16434,[1662]=1026,[1663]=12297,[1664]=526,[1665]=32822,[1672]=4151,
  [1687]=541,[1688]=29738,[1690]=16440,[1691]=16394,[1692]=65546,[1693]=1034,
  [1699]=262153,[1700]=65550,[1701]=131078,[1705]=8201,[1706]=4105,
  [1708]=459281,[1709]=85519,[1710]=85523,[1711]=65578,[1712]=85514,
  [1713]=85513,[1714]=16394,[1715]=16399,[1716]=1034,[1717]=65537,[1718]=1043,
  [1719]=8230,[1720]=16390,[1721]=16399,[1722]=82959,[1723]=8207,[1725]=82988,
  [1726]=150018,[1727]=131074,[1728]=118807,[1729]=436749,[1730]=247818,
  [1731]=150018,[1734]=508422,[1735]=36881,[1736]=150035,[1737]=26122,
  [1738]=18954,[1739]=426502,[1740]=84490,[1741]=491530,[1743]=131634,
  [1744]=131594,[1749]=220691,[1750]=4625,[1752]=16407,[1753]=16413,
  [1754]=32797,[1755]=262173,[1756]=262153,[1759]=16393,[1760]=16399,
  [1761]=180753,[1762]=304143,[1763]=270857,[1764]=2105,[1765]=4153,
  [1766]=1081,[1773]=32825,[1774]=16441,[1775]=215054,[1776]=270874,
  [1777]=554,[1778]=149517,[1802]=262154,[1803]=32778,[1804]=514,[1805]=4102,
  [1806]=32778,[1807]=65538,[1808]=262146,[1809]=414210,[1810]=8706,
  [1828]=8235,[1884]=8202,[1885]=262163,[1886]=4111,[1887]=65546,[1888]=8202,
  [1889]=131082,[1890]=2058,[1903]=4154,[1907]=16399,[1911]=522,[1912]=8213,
  [1913]=232970,[1914]=215050,[1915]=294410,[1917]=1551,[1918]=262154,
  [1919]=262154,[1920]=65553,[1921]=1083,[1922]=16425,[1926]=32792,
  [1927]=16399,[1928]=65551,[1929]=522,[1930]=262154,[1931]=16398,[1932]=8206,
  [1933]=131082,[1934]=8201,[1935]=562,[1936]=16427,[1938]=8232,[1939]=16424,
  [1940]=16423,[1941]=1043,[1943]=2054,[1949]=65546,[1952]=522,[1953]=165948,
  [1954]=147466,[1955]=1028,[1956]=266249,[1957]=520,[1958]=75274,[1959]=4157,
  [1960]=522,[1961]=274494,[1962]=16394,[1963]=522,[1964]=392714,[1965]=41514,
  [1966]=131082,[1967]=555,[1968]=149567,[1969]=2090,[1974]=2058,[1975]=8202,
  [1976]=1034,[1977]=16394,[1984]=307219,[1997]=1073,[1998]=4106,
  [1999]=182282,[2000]=90122,[2001]=270912,[2002]=4121,[2003]=4105,
  [2004]=8201,[2017]=1039,[2018]=65546,[2022]=577,[2035]=8202,[2036]=65546,
  [2037]=16394,[2041]=8200,[2042]=16434,[2047]=2088,[2049]=262152,[2050]=2058,
  [2051]=131138,[2057]=149523,[2058]=204809,[2062]=16403,[2063]=265235,
  [2064]=16443,[2065]=3594,[2071]=8202,[2072]=522,[2076]=67,[2077]=16386,
  [2078]=4104,[2079]=270378,[2080]=555,[2081]=213002,[2082]=133139,
  [2083]=312360,[2084]=16422,[2085]=2086,[2086]=197638,[2087]=16394,
  [2088]=34821,[2089]=458762,[2090]=345129,[2091]=16393,[2092]=8201,
  [2093]=1033,[2113]=16427,[2114]=65578,[2115]=262159,[2116]=32787,
  [2117]=1038,[2118]=4105,[2119]=1033,[2120]=2063,[2121]=1032,[2122]=90120,
  [2123]=307208,[2124]=161290,[2126]=502282,[2127]=32777,[2128]=16906,
  [2129]=16906,[2130]=227897,[2131]=203323,[2132]=206375,[2133]=469523,
  [2134]=508425,[2135]=82958,[2143]=32778,[2157]=527,[2158]=131129,
  [2163]=8233,[2165]=8211,[2184]=32778,[2185]=2058,[2186]=16394,[2187]=4106,
  [2188]=16394,[2189]=16394,[2190]=2058,[2192]=522,[2196]=16394,[2197]=8202,
  [2198]=131082,[2199]=1034,[2201]=522,[2202]=8202,[2352]=554,[2372]=523786,
  [2373]=517642,[2374]=331274,[2375]=407050,[2376]=368166,[2377]=204356,
  [2378]=262710,[2379]=390713,[2380]=386566,[2381]=266250,[2382]=30250,
  [2383]=160266,[2384]=199749,[2385]=182282,[2386]=266822,[2387]=173611,
  [2388]=182335,[2389]=387082,[2390]=297543,[2392]=178760,[2393]=307221,
  [2394]=459334,[2395]=91209,[2397]=446023,[2398]=2122,[2399]=2123,
  [2400]=100874,[2401]=8231,[2402]=262198,[2403]=588,[2404]=131082,
  [2405]=131112,[2406]=522,[2407]=65574,[2408]=262154,[2409]=583,[2410]=8235,
  [2411]=32845,[2412]=8201,[2413]=65609,[2414]=16462,[2415]=2058,[2416]=533,
  [2417]=1080,[2418]=16455,[2419]=131082,[2420]=65612,[2421]=65546,
  [2422]=2086,[2423]=8271,[2424]=522,[2425]=262214,[2426]=2119,[2427]=8271,
  [2428]=1104,[2429]=4117,[2430]=16441,[2431]=16390,[2432]=168450,[2433]=2058,
  [2434]=45607,[2435]=531,[2436]=12296,[2437]=35338,[2438]=133647,
  [2439]=65565,[2440]=45610,[2441]=2570,[2442]=16394,[2443]=12817,
  [2444]=12817,[2445]=8254,[2446]=262225,[2447]=131082,[2448]=32850,
  [2449]=8271,[2450]=16467,[2451]=2058,[2452]=8276,[2453]=262229,[2454]=1110,
  [2455]=65623,[2456]=131160,[2457]=16473,[2458]=4186,[2459]=4186,[2460]=2139,
  [2461]=131164,[2462]=2135,[2463]=32861,[2464]=1104,[2465]=8272,[2466]=1090,
  [2467]=2142,[2468]=4191,[2469]=32837,[2471]=2144,[2472]=4166,[2473]=1121,
  [2474]=4106,[2475]=2058,[2476]=16394,[2477]=522,[2478]=65626,[2479]=65626,
  [2525]=2086,[2526]=4155,[2527]=16464,[2528]=8258,[2529]=610,[2530]=16483,
  [2531]=32868,[2532]=1111,[2533]=4197,[2534]=1118,[2535]=8294,[2537]=69170,
  [2538]=32861,[2539]=2090,[2540]=615,[2541]=131175,[2544]=16485,[2545]=1034,
  [2546]=131121,[2547]=8293,[2548]=4200,[2549]=1112,[2550]=32837,[2551]=8220,
  [2552]=131177,[2553]=2058,[2554]=9322,[2555]=65639,[2556]=131086,
  [2557]=8299,[2558]=1032,[2559]=2156,[2560]=16473,[2561]=32877,[2562]=7272,
  [2563]=8280,[2564]=16454,[2565]=2122,[2566]=589,[2567]=16494,[2568]=16385,
  [2569]=4207,[2575]=16460,[2576]=262199,[2577]=2160,[2578]=131185,
  [2579]=4169,[2580]=1138,[2581]=131185,[2582]=262259,[2583]=16407,
  [2584]=131122,[2585]=1026,[2586]=4170,[2587]=4212,[2589]=131096,
  [2590]=65653,[2591]=1142,[2621]=8236,[2622]=2167,[2623]=65602,[2638]=4216,
  [2645]=90745,[2646]=90234,[2647]=303739,[2648]=149628,[2649]=17533,
  [2650]=459390,[2651]=149631,[2652]=1152,[2653]=307841,[2657]=8315,
  [2658]=24706,[2659]=262787,[2660]=270980,[2661]=459397,[2662]=32865,
  [2663]=438406,[2664]=12296,[2665]=182313,[2666]=8231,[2667]=516231,
  [2668]=133768,[2669]=426633,[2670]=460938,[2671]=2062,[2672]=467083,
  [2673]=473740,[2674]=653,[2675]=166542,[2676]=393850,[2677]=90255,
  [2678]=248976,[2680]=262185,[2681]=65681,[2682]=658,[2683]=131135,
  [2684]=307347,[2685]=459412,[2686]=4186,[2687]=8341,[2688]=8321,
  [2689]=16534,[2690]=16535,[2691]=1176,[2692]=2201,[2693]=32922,
  [2694]=248925,[2695]=91291,[2696]=131153,[2697]=668,[2698]=262301,
  [2699]=65694,[2700]=32927,[2701]=8352,[2702]=16537,[2703]=32929,
  [2704]=295074,[2706]=4259,[2707]=8356,[2708]=1189,[2709]=67732,[2710]=16550,
  [2711]=16551,[2712]=2216,[2713]=262313,[2714]=682,[2715]=131121,
  [2716]=65578,[2717]=8363,[2718]=4268,[2719]=32941,[2720]=2222,[2721]=65645,
  [2747]=8310,[2748]=8367,[2749]=1200,[2750]=16561,[2753]=4145,[2754]=16562,
  [2755]=8371,[2756]=1204,[2757]=307374,[2758]=69301,[2760]=69301,[2761]=7737,
  [2762]=90294,[2763]=20125,[2765]=459370,[2766]=4279,[2767]=16568,
  [2776]=131257,[2777]=1081,[2778]=4186,[2779]=32954,[2780]=262331,
  [2792]=68796,[2793]=3694,[2794]=18621,[2795]=16574,[2796]=555,[2797]=16427,
  [2798]=8201,[2832]=16575,[2833]=4288,[2834]=8385,[2835]=16578,[2836]=16579,
  [2837]=1219,[2838]=2244,[2839]=16581,[2840]=1222,[2841]=1034,[2842]=1223,
  [2843]=527,[2844]=527,[2845]=16584,[2846]=1225,[2847]=1225,[2848]=8394,
  [2849]=4150,[2850]=16583,[2851]=16587,[2852]=4300,[2853]=16501,
  [2863]=285901,[2864]=266958,[2865]=25717,[2866]=182389,[2867]=7375,
  [2868]=2166,[2869]=1232,[2870]=16591,[2872]=2257,[2878]=8402,[2888]=131283,
  [2889]=46144,[2890]=8404,[2891]=131285,[2892]=17432,[2893]=2121,
  [2894]=50390,[2895]=459293,[2896]=45110,[2897]=28887,[2898]=66776,
  [2899]=65608,[2900]=2120,[2901]=180296,[2902]=183513,[2903]=459481,
  [2904]=16601,[2905]=2258,[2907]=458962,[2908]=35034,[2909]=16602,
  [2910]=65755,[2911]=2267,[2912]=8411,[2913]=131291,[2914]=16604,
  [2915]=131292,[2916]=32989,[2917]=131293,[2918]=733,[2919]=90717,
  [2920]=91229,[2921]=1117,[2922]=17628,[2923]=2111,[2924]=182335,
  [2925]=74970,[2926]=205018,[2927]=297546,[2928]=16458,[2929]=459338,
  [2930]=307422,[2931]=4318,[2932]=303326,[2933]=16594,[2934]=1234,[2935]=722,
  [2936]=197330,[2937]=17618,[2938]=197183,[2939]=150079,[2940]=81983,
  [2941]=2268,[2942]=188636,[2943]=19679,[2944]=1052,[2945]=4186,
  [2946]=307290,[2947]=360661,[2948]=83157,[2949]=18645,[2950]=245984,
  [2952]=82953,[2953]=295433,[2954]=32825,[2955]=49209,[2956]=106553,
  [2957]=294995,[2958]=8275,[2959]=617,[2960]=2057,[2961]=17436,[2962]=1109,
  [2963]=65621,[2964]=84573,[2965]=725,[2966]=4321,[2967]=4160,[3006]=4313,
  [3007]=197333,[3008]=2274,[3009]=1043,[3010]=531,[3011]=2067,[3012]=4115,
  [3013]=9273,[3014]=90851,[3015]=459491,[3016]=32822,[3017]=8246,[3018]=4150,
  [3019]=4150,[3020]=166108,[3021]=182492,[3022]=2268,[3023]=16604,
  [3024]=8277,[3025]=2272,[3026]=12516,[3027]=295140,[3028]=66670,
  [3029]=18542,[3030]=24805,[3032]=66789,[3033]=303183,[3034]=16614,
  [3035]=327901,[3036]=1229,[3037]=82151,[3038]=8932,[3039]=49381,
  [3040]=131694,[3041]=4328,[3042]=4329,[3043]=16618,[3044]=17629,
  [3045]=32777,[3046]=16619,[3047]=2131,[3049]=459305,[3050]=281301,
  [3051]=463369,[3052]=459274,[3053]=16620,[3054]=16610,[3061]=262377,
  [3062]=8425,[3063]=166078,[3064]=16574,[3065]=1214,[3066]=131220,
  [3067]=16459,[3079]=16386,[3080]=475346,[3081]=355037,[3082]=248539,
  [3083]=248437,[3092]=33005,[3097]=4166,[3098]=8277,[3099]=1247,[3100]=1262,
  [3101]=16594,[3102]=166620,[3103]=18655,[3104]=8262,[3105]=751,[3106]=33008,
  [3107]=2174,[3108]=133183,[3109]=33343,[3110]=16447,[3111]=164593,
  [3112]=133873,[3113]=8433,[3114]=328277,[3115]=215264,[3116]=16477,
  [3117]=8285,[3118]=180965,[3119]=200302,[3120]=307301,[3121]=8293,
  [3122]=1125,[3123]=303844,[3124]=12516,[3125]=2127,[3126]=303695,
  [3127]=1266,[3128]=16428,[3129]=1267,[3130]=262388,[3131]=33524,[3132]=8436,
  [3133]=4340,[3134]=51263,[3135]=360511,[3136]=8255,[3137]=4159,
  [3138]=262207,[3139]=459303,[3140]=4135,[3141]=230114,[3153]=131317,
  [3169]=32777,[3170]=32777,[3171]=32777,[3172]=1039,[3173]=274965,[3174]=758,
  [3175]=16426,[3176]=758,[3177]=8439,[3178]=758,[3179]=537,[3180]=1045,
  [3181]=533,[3188]=190,[3189]=2061,[3190]=436749,[3191]=436749,[3196]=151286,
  [3197]=760,[3200]=2114,[3201]=514,[3202]=133634,[3203]=133634,[3204]=526,
  [3205]=45582,[3206]=36366,[3207]=531,[3208]=2579,[3209]=2067,[3210]=3091,
  [3211]=522,[3212]=459274,[3213]=216310,[3214]=2294,[3215]=49689,
  [3216]=19192,[3217]=3613,[3218]=395786,[3219]=264730,[3220]=2058,
  [3221]=65780,[3222]=538,[3223]=760,[3224]=526,[3225]=2058,[3226]=2058,
  [3227]=537,[3229]=541,[3230]=541,[3231]=541,[3232]=2061,[3233]=538,
  [3234]=531,[3235]=538,[3236]=65550,[3237]=760,[3242]=249,[3243]=1039,
  [3244]=8209,[3245]=8202,[3246]=250,[3248]=4347,[3249]=1039,[3250]=526,
  [3251]=16388,[3252]=65564,[3253]=262152,[3254]=1053,[3255]=2293,[3256]=2049,
  [3259]=2061,[3260]=35334,[3261]=527,[3262]=521,[3263]=262145,[3264]=522,
  [3265]=4186,[3266]=2067,[3269]=262154,[3270]=605,[3272]=436749,
  [3273]=436745,[3274]=8444,[3275]=2054,[3276]=51718,[3278]=2054,
  [3279]=262242,[3280]=4097,[3281]=262710,[3282]=459274,[3283]=516,
  [3284]=8246,[3285]=8246,[3286]=4106,[3287]=16394,[3288]=307210,[3289]=16637,
  [3290]=1048,[3291]=4104,[3292]=766,[3293]=262399,[3294]=1280,[3295]=307307,
  [3296]=307307,[3297]=32875,[3299]=16637,[3300]=182362,[3301]=459521,
  [3302]=769,[3303]=769,[3306]=569,[3307]=459521,[3309]=32858,[3310]=16637,
  [3311]=2111,[3313]=150626,[3316]=262242,[3317]=2146,[3318]=150626,
  [3319]=8274,[3320]=336466,[3321]=8206,[3322]=74254,[3323]=8206,[3325]=550,
  [3326]=619,[3327]=41579,[3328]=41486,[3329]=41579,[3330]=41579,[3331]=522,
  [3332]=16394,[3333]=32850,[3334]=32850,[3335]=32850,[3336]=32850,
  [3338]=2098,[3342]=554,[3344]=2067,[3345]=2063,[3346]=2054,[3347]=2062,
  [3348]=16403,[3350]=2098,[3351]=9738,[3352]=9738,[3353]=33290,[3354]=33334,
  [3355]=16637,[3356]=522,[3357]=32778,[3358]=32778,[3359]=522,[3360]=591,
  [3361]=521,[3362]=521,[3365]=513,[3366]=83471,[3367]=12809,[3368]=16386,
  [3376]=527,[3378]=262242,[3379]=262242,[3380]=4354,[3381]=131257,
  [3382]=8207,[3384]=182335,[3385]=150626,[3389]=182286,[3390]=16388,
  [3403]=39171,[3404]=459278,[3405]=4351,[3406]=518,[3407]=16422,[3408]=16644,
  [3409]=4126,[3410]=16413,[3411]=16454,[3412]=16494,[3414]=262172,
  [3415]=4111,[3416]=2062,[3417]=1034,[3425]=261,[3427]=262208,[3446]=4358,
  [3447]=4359,[3448]=4098,[3449]=4160,[3475]=569,[3476]=562,[3477]=459337,
  [3478]=38988,[3479]=91753,[3480]=36360,[3481]=71172,[3482]=274966,
  [3483]=2579,[3484]=37397,[3485]=19661,[3486]=39171,[3487]=262690,
  [3488]=12821,[3489]=18963,[3490]=267281,[3491]=1038,[3493]=32774,
  [3511]=16454,[3512]=16454,[3513]=73,[3514]=73,[3515]=585,[3516]=585,
  [3517]=73,[3518]=4172,[3519]=12,[3520]=105,[3521]=597,[3522]=85,[3523]=597,
  [3524]=597,[3525]=16394,[3526]=10,[3527]=10,[3528]=520,[3529]=520,
  [3530]=1036,[3531]=12,[3532]=12,[3533]=524,[3534]=12,[3535]=529,[3536]=524,
  [3537]=546,[3538]=537,[3539]=34,[3540]=546,[3541]=533,[3542]=533,[3543]=21,
  [3544]=21,[3545]=531,[3546]=531,[3547]=531,[3548]=8204,[3549]=533,
  [3550]=533,[3551]=533,[3552]=533,[3553]=533,[3554]=21,[3555]=533,[3556]=21,
  [3557]=776,[3578]=1051,[3579]=32777,[3580]=8209,[3582]=33021,[3588]=4131,
  [3596]=1094,[3597]=547,[3600]=585,[3602]=527,[4253]=16422,[4255]=8201,
  [4257]=777,[4258]=777,[4259]=777,[4260]=535,[4261]=522,[4262]=777,
  [4263]=131110,[4264]=585,[4265]=1052,[4266]=527,[4267]=1048,[4275]=9801,
  [4276]=26378,[4277]=412170,[4278]=428558,[4279]=1559,[4280]=426506,
  [4285]=1041,[4286]=526,[4287]=4100,[4288]=1039,[4289]=1054,[4290]=1038,
  [4291]=1068,[4292]=2160,[4295]=522,[4296]=1048,[4297]=16394,[4298]=1291,
  [4299]=32778,[4300]=1038,[4302]=1067,[4303]=9738,[4304]=526,[4305]=2067,
  [4306]=262153,[4307]=4150,[4308]=1028,[4309]=8226,[4310]=1047,[4311]=1097,
  [4316]=1292,[4402]=1284,[4406]=16386,[4407]=4117,[4408]=8209,[4409]=2067,
  [4410]=16653,[4411]=2117,[4412]=8254,[4421]=2053,[4425]=262414,[4426]=65590,
  [4436]=535,[4437]=65780,[4450]=8220,[4451]=4105,[4452]=65558,[4455]=4367,
  [4456]=220943,[4457]=220943,[4460]=409126,[4461]=409090,[4462]=8236,
  [4463]=1296,[4464]=785,[4465]=551,[4466]=16658,[4467]=131347,[4469]=131074,
  [4470]=65546,[4471]=523826,[4472]=131182,[4473]=1300,[4474]=277,
  [4476]=131095,[4477]=524031,[4480]=523777,[4481]=523795,[4482]=523786,
  [4483]=307254,[4484]=307208,[4485]=303650,[4489]=131083,[4490]=2053,
  [4491]=32791,[4492]=4136,[4495]=32847,[4496]=33046,[4498]=524031,
  [4499]=523826,[4500]=32797,[4506]=2078,[4507]=524049,[4510]=214287,
  [4511]=2050,[4512]=3,[4513]=131150,[4514]=216339,[4515]=216339,
  [4516]=216339,[4517]=1048,[4518]=303624,[4519]=8,[4520]=131097,
  [4521]=131091,[4522]=131087,[4524]=2158,[4525]=523783,[4526]=524055,
  [4527]=33048,[4529]=523801,[4530]=4376,[4533]=216081,[4534]=32810,
  [4535]=216308,[4536]=262161,[4537]=551,[4538]=523779,[4539]=523806,
  [4540]=523786,[4541]=523786,[4542]=131076,[4543]=16665,[4544]=524038,
  [4545]=34,[4546]=534,[4548]=262161,[4565]=131354,[4566]=131355,[4568]=65541,
  [4569]=8,[4570]=16399,[4571]=303655,[4573]=303624,[4574]=303625,[4575]=796,
  [4576]=32789,[4577]=16399,[4579]=4381,[4580]=1048,[4581]=262153,
  [4582]=262153,[4586]=2084,[4589]=522,[4590]=535,[4591]=518,[4592]=8436,
  [4593]=8234,[4594]=32806,[4595]=1310,[4597]=799,[4598]=678,[4599]=262163,
  [4602]=529,[4614]=262154,[4615]=529,[4616]=65824,[4617]=517,[4618]=533,
  [4628]=360962,[4629]=16673,[4630]=33058,[4631]=32782,[4632]=262198,
  [4635]=131110,[4636]=65796,[4637]=65779,[4638]=8483,[4639]=16676,
  [4640]=1048,[4641]=1297,[4642]=16669,[4643]=4366,[4644]=8246,[4645]=65810,
  [4646]=2301,[4647]=131346,[4648]=65565,[4649]=8236,[4650]=8226,
  [4651]=523820,[4652]=524036,[4653]=262437,[4654]=523805,[4655]=8465,
  [4656]=523820,[4657]=523820,[4658]=524020,[4659]=523815,[4660]=523840,
  [4661]=131146,[4662]=524042,[4663]=523850,[4664]=8445,[4666]=523815,
  [4667]=523830,[4668]=523820,[4669]=8213,[4678]=541,[4679]=541,[4682]=16403,
  [4684]=18655,[4686]=1062,[4689]=65578,[4690]=131366,[4691]=514,[4692]=32789,
  [4693]=523817,[4694]=32778,[4695]=16440,[4701]=16650,[4702]=365073,
  [4703]=365067,[4704]=761,[4708]=131110,[4710]=223746,[4711]=224039,
  [4717]=273,[4718]=1025,[4719]=16637,[4723]=18946,[4724]=270351,[4726]=2050,
  [4727]=4107,[4728]=65764,[4729]=8213,[4730]=253,[4731]=67586,[4732]=82728,
  [4733]=1321,[4747]=298,[4748]=29,[4749]=38,[4750]=110,[4756]=28,[4757]=4324,
  [4759]=16650,[4761]=5,[4762]=2086,[4791]=33017,[4792]=5,[4793]=32773,
  [4794]=65810,[4804]=131371,[4806]=17,[4849]=1,[4852]=2,
};

-------------------------------------------------------------------------------
--                 A  D  D  O  N     V  A  R  I  A  B  L  E  S
-------------------------------------------------------------------------------

L.petSpeciesMaxId  = table.maxn(speciesInfo);
L.petSpeciesRanges =
{
  {824,               833}, -- Species using standard pet family icons
  {  1,               823},
  {834, L.petSpeciesMaxId}
};

-------------------------------------------------------------------------------
--                 L  O  C  A  L     F  U  N  C  T  I  O  N  S
-------------------------------------------------------------------------------

-------------------------------------------------------------------------------
--                 A  D  D  O  N     F  U  N  C  T  I  O  N  S
-------------------------------------------------------------------------------

function L.petGetBreed(petGuid)
  -- Local Variables
  local _;
  local baseStat;
  local breedsHealth = 0;
  local breedsPower = 0;
  local breedsSpeed = 0;
  local knownBreeds;
  local petBreed;
  local petHealth;
  local petLevel;
  local petMultiplier;
  local petPower;
  local petQuality;
  local petSpeciesId;
  local petSpeed;
  local petStatProfile;

  -- Get the pet's species and level
  petSpeciesId, _, petLevel = cpjGetPetInfoByPetID(petGuid);
  if ((petSpeciesId ~= nil) and (speciesInfo[petSpeciesId] ~= nil)) then
    -- Get the pet's stats
    _, petHealth, petPower, petSpeed, petQuality = cpjGetPetStats(petGuid);
    if (petPower ~= nil) then
      -- Work out the multiplier for the pet's quality and level
      petMultiplier  = (1+((petQuality-1)/10))*petLevel;
      petStatProfile = baseStatProfiles[speciesInfo[petSpeciesId]%512];

      -- Work out the possible breeds the pet could be, based on its power
      baseStat  = petStatProfile[2];
      breedMask = 0;
      if (floor((baseStat*petMultiplier)+0.4999) == petPower) then
        breedMask = breedMask+0x0000004C;
      end
      if (floor(((baseStat+0.4)*petMultiplier)+0.4999) == petPower) then
        breedMask = breedMask+0x00000300;
      end
      if (floor(((baseStat+0.5)*petMultiplier)+0.4999) == petPower) then
        breedMask = breedMask+0x00000001;
      end
      if (floor(((baseStat+0.9)*petMultiplier)+0.4999) == petPower) then
        breedMask = breedMask+0x000000B0;
      end
      if (floor(((baseStat+2.0)*petMultiplier)+0.4999) == petPower) then
        breedMask = breedMask+0x00000002;
      end
      petBreed = breedMask;

      -- Work out the possible breeds the pet could be, based on its speed
      baseStat  = petStatProfile[3];
      breedMask = 0;
      if (floor((baseStat*petMultiplier)+0.4999) == petSpeed) then
        breedMask = breedMask+0x0000001A;
      end
      if (floor(((baseStat+0.4)*petMultiplier)+0.4999) == petSpeed) then
        breedMask = breedMask+0x00000280;
      end
      if (floor(((baseStat+0.5)*petMultiplier)+0.4999) == petSpeed) then
        breedMask = breedMask+0x00000001;
      end
      if (floor(((baseStat+0.9)*petMultiplier)+0.4999) == petSpeed) then
        breedMask = breedMask+0x00000160;
      end
      if (floor(((baseStat+2.0)*petMultiplier)+0.4999) == petSpeed) then
        breedMask = breedMask+0x00000004;
      end
      petBreed = bitAnd(petBreed, breedMask);

      -- Adjust some variables to make the Health calculations simpler
      petHealth     = petHealth-100;
      petMultiplier = petMultiplier*5;
     
      -- Work out the possible breeds the pet could be, based on its health
      baseStat  = petStatProfile[1];
      breedMask = 0;
      if (floor((baseStat*petMultiplier)+0.4999) == petHealth) then
        breedMask = breedMask+0x00000026;
      end
      if (floor(((baseStat+0.4)*petMultiplier)+0.4999) == petHealth) then
        breedMask = breedMask+0x00000180;
      end
      if (floor(((baseStat+0.5)*petMultiplier)+0.4999) == petHealth) then
        breedMask = breedMask+0x00000001;
      end
      if (floor(((baseStat+0.9)*petMultiplier)+0.4999) == petHealth) then
        breedMask = breedMask+0x00000250;
      end
      if (floor(((baseStat+2.0)*petMultiplier)+0.4999) == petHealth) then
        breedMask = breedMask+0x00000008;
      end
      petBreed = bitAnd(petBreed, breedMask);
    end

    -- Apply the available breeds bit mask for the pet's species, if known
    knownBreeds = bit.rshift(speciesInfo[petSpeciesId], 9);
    if (knownBreeds > 0) then
      petBreed = bitAnd(petBreed, knownBreeds);
    end
  end

  return (petBreeds[petBreed] or "(?/?)");
end
